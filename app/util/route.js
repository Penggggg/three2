"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var MAX_PAGES = 9;
var makeQuery = function (url) {
    var params = {};
    var path = url.split('?')[1];
    if (!path) {
        return params;
    }
    var paramsArr = path.split('&');
    paramsArr.map(function (paramsSet) {
        var _a;
        params = Object.assign({}, params, (_a = {},
            _a[paramsSet.split('=')[0]] = paramsSet.split('=')[1],
            _a));
    });
    return params;
};
var judgeEqual = function (obj1, obj2) {
    var key1 = Object.keys(obj1);
    var key2 = Object.keys(obj2);
    if (key1.length !== key2.length) {
        return;
    }
    return !key1.some(function (keyx1) { return obj1[keyx1] !== obj2[keyx1]; });
};
exports.navTo = function (url) {
    var pages = getCurrentPages();
    var pageLen = pages.length;
    var params = makeQuery(url);
    var existedTarget = pages.find(function (x) { return "/" + x.route === url.split('?')[0]; });
    var existedIndex = pages.findIndex(function (x) { return "/" + x.route === url.split('?')[0]; });
    if (!!existedTarget) {
        var isParamEqual = judgeEqual(params, existedTarget.options);
        if (isParamEqual) {
            wx.navigateBack({
                delta: pageLen - existedIndex - 1
            });
        }
        else {
            if (pageLen < MAX_PAGES) {
                wx.navigateTo({
                    url: url
                });
            }
            else {
                wx.redirectTo({
                    url: url
                });
            }
        }
    }
    else {
        if (pageLen < MAX_PAGES) {
            wx.navigateTo({
                url: url
            });
        }
        else {
            wx.redirectTo({
                url: url
            });
        }
    }
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicm91dGUuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJyb3V0ZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBLElBQU0sU0FBUyxHQUFHLENBQUMsQ0FBQztBQUdwQixJQUFNLFNBQVMsR0FBRyxVQUFFLEdBQVc7SUFDM0IsSUFBSSxNQUFNLEdBQUcsRUFBRyxDQUFDO0lBQ2pCLElBQU0sSUFBSSxHQUFHLEdBQUcsQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLENBQUUsQ0FBQyxDQUFFLENBQUM7SUFFakMsSUFBSyxDQUFDLElBQUksRUFBRztRQUNULE9BQU8sTUFBTSxDQUFDO0tBQ2pCO0lBRUQsSUFBTSxTQUFTLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQztJQUNsQyxTQUFTLENBQUMsR0FBRyxDQUFFLFVBQUEsU0FBUzs7UUFDcEIsTUFBTSxHQUFHLE1BQU0sQ0FBQyxNQUFNLENBQUMsRUFBRyxFQUFFLE1BQU07WUFDOUIsR0FBRSxTQUFTLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFFLENBQUMsQ0FBRSxJQUFJLFNBQVMsQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLENBQUUsQ0FBQyxDQUFFO2dCQUMxRCxDQUFBO0lBQ04sQ0FBQyxDQUFDLENBQUM7SUFDSCxPQUFPLE1BQU0sQ0FBQztBQUNsQixDQUFDLENBQUM7QUFNRixJQUFNLFVBQVUsR0FBRyxVQUFFLElBQVksRUFBRSxJQUFZO0lBQzNDLElBQU0sSUFBSSxHQUFHLE1BQU0sQ0FBQyxJQUFJLENBQUUsSUFBSSxDQUFFLENBQUM7SUFDakMsSUFBTSxJQUFJLEdBQUcsTUFBTSxDQUFDLElBQUksQ0FBRSxJQUFJLENBQUUsQ0FBQztJQUNqQyxJQUFLLElBQUksQ0FBQyxNQUFNLEtBQUssSUFBSSxDQUFDLE1BQU0sRUFBRztRQUFFLE9BQU87S0FBRTtJQUM5QyxPQUFPLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBRSxVQUFBLEtBQUssSUFBSSxPQUFBLElBQUksQ0FBRSxLQUFLLENBQUUsS0FBSyxJQUFJLENBQUUsS0FBSyxDQUFFLEVBQS9CLENBQStCLENBQUMsQ0FBQztBQUNqRSxDQUFDLENBQUM7QUFPVyxRQUFBLEtBQUssR0FBRyxVQUFFLEdBQVc7SUFFMUIsSUFBTSxLQUFLLEdBQUcsZUFBZSxFQUFHLENBQUM7SUFDakMsSUFBTSxPQUFPLEdBQUcsS0FBSyxDQUFDLE1BQU0sQ0FBQztJQUM3QixJQUFNLE1BQU0sR0FBRyxTQUFTLENBQUUsR0FBRyxDQUFFLENBQUM7SUFDaEMsSUFBTSxhQUFhLEdBQVEsS0FBSyxDQUFDLElBQUksQ0FBRSxVQUFBLENBQUMsSUFBSSxPQUFBLE1BQUksQ0FBQyxDQUFDLEtBQU8sS0FBSyxHQUFHLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFHLENBQUMsQ0FBRSxFQUF0QyxDQUFzQyxDQUFDLENBQUM7SUFDcEYsSUFBTSxZQUFZLEdBQUcsS0FBSyxDQUFDLFNBQVMsQ0FBRSxVQUFBLENBQUMsSUFBSSxPQUFBLE1BQUksQ0FBQyxDQUFDLEtBQU8sS0FBSyxHQUFHLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFHLENBQUMsQ0FBRSxFQUF0QyxDQUFzQyxDQUFDLENBQUM7SUFHbkYsSUFBSyxDQUFDLENBQUMsYUFBYSxFQUFHO1FBRW5CLElBQU0sWUFBWSxHQUFHLFVBQVUsQ0FBRSxNQUFNLEVBQUUsYUFBYSxDQUFDLE9BQU8sQ0FBRSxDQUFDO1FBRWpFLElBQUssWUFBWSxFQUFHO1lBRWhCLEVBQUUsQ0FBQyxZQUFZLENBQUM7Z0JBQ1osS0FBSyxFQUFFLE9BQU8sR0FBRyxZQUFZLEdBQUcsQ0FBQzthQUNwQyxDQUFDLENBQUM7U0FHTjthQUFNO1lBU0gsSUFBSyxPQUFPLEdBQUcsU0FBUyxFQUFHO2dCQUN2QixFQUFFLENBQUMsVUFBVSxDQUFDO29CQUNWLEdBQUcsS0FBQTtpQkFDTixDQUFDLENBQUM7YUFHTjtpQkFBTTtnQkFDSCxFQUFFLENBQUMsVUFBVSxDQUFDO29CQUNWLEdBQUcsS0FBQTtpQkFDTixDQUFDLENBQUM7YUFDTjtTQUNKO0tBRUo7U0FBTTtRQUdILElBQUssT0FBTyxHQUFHLFNBQVMsRUFBRztZQUN2QixFQUFFLENBQUMsVUFBVSxDQUFDO2dCQUNWLEdBQUcsS0FBQTthQUNOLENBQUMsQ0FBQztTQUdOO2FBQU07WUFDSCxFQUFFLENBQUMsVUFBVSxDQUFDO2dCQUNWLEdBQUcsS0FBQTthQUNOLENBQUMsQ0FBQztTQUNOO0tBQ0o7QUFDVCxDQUFDLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBNQVhfUEFHRVMgPSA5O1xuXG4vKiog5qC55o2udXJsIOi/lOWbnnBhcmFt5a+56LGhICovXG5jb25zdCBtYWtlUXVlcnkgPSAoIHVybDogc3RyaW5nICkgPT4ge1xuICAgIGxldCBwYXJhbXMgPSB7IH07XG4gICAgY29uc3QgcGF0aCA9IHVybC5zcGxpdCgnPycpWyAxIF07XG5cbiAgICBpZiAoICFwYXRoICkge1xuICAgICAgICByZXR1cm4gcGFyYW1zO1xuICAgIH1cblxuICAgIGNvbnN0IHBhcmFtc0FyciA9IHBhdGguc3BsaXQoJyYnKTtcbiAgICBwYXJhbXNBcnIubWFwKCBwYXJhbXNTZXQgPT4ge1xuICAgICAgICBwYXJhbXMgPSBPYmplY3QuYXNzaWduKHsgfSwgcGFyYW1zLCB7XG4gICAgICAgICAgICBbIHBhcmFtc1NldC5zcGxpdCgnPScpWyAwIF1dOiAgcGFyYW1zU2V0LnNwbGl0KCc9JylbIDEgXVxuICAgICAgICB9KVxuICAgIH0pO1xuICAgIHJldHVybiBwYXJhbXM7XG59O1xuXG4vKiogXG4gKiAhIOatpOWHveaVsOaciea8j+a0nlxuICog5Yik5pat5Lik5LiqcGFyYW1z5a+56LGh5piv5ZCm55u4562JXG4gKi9cbmNvbnN0IGp1ZGdlRXF1YWwgPSAoIG9iajE6IG9iamVjdCwgb2JqMjogb2JqZWN0ICkgPT4ge1xuICAgIGNvbnN0IGtleTEgPSBPYmplY3Qua2V5cyggb2JqMSApO1xuICAgIGNvbnN0IGtleTIgPSBPYmplY3Qua2V5cyggb2JqMiApO1xuICAgIGlmICgga2V5MS5sZW5ndGggIT09IGtleTIubGVuZ3RoICkgeyByZXR1cm47IH1cbiAgICByZXR1cm4gIWtleTEuc29tZSgga2V5eDEgPT4gb2JqMVsga2V5eDEgXSAhPT0gb2JqMlsga2V5eDEgXSk7XG59O1xuXG4vKipcbiAqIFxuICog6L+e57utMuS4quebuOWQjHVybO+8jOS4jeWQjHF1ZXJ577yMXG4gKiBBIC0+IEIg55qE5pe25YCZ77yMcXVlcnnlj4LmlbDlj6/og73mnInpl67pophcbiAqL1xuZXhwb3J0IGNvbnN0IG5hdlRvID0gKCB1cmw6IHN0cmluZyApID0+IHtcblxuICAgICAgICBjb25zdCBwYWdlcyA9IGdldEN1cnJlbnRQYWdlcyggKTtcbiAgICAgICAgY29uc3QgcGFnZUxlbiA9IHBhZ2VzLmxlbmd0aDtcbiAgICAgICAgY29uc3QgcGFyYW1zID0gbWFrZVF1ZXJ5KCB1cmwgKTtcbiAgICAgICAgY29uc3QgZXhpc3RlZFRhcmdldDogYW55ID0gcGFnZXMuZmluZCggeCA9PiBgLyR7eC5yb3V0ZX1gID09PSB1cmwuc3BsaXQoJz8nKSBbIDAgXSk7XG4gICAgICAgIGNvbnN0IGV4aXN0ZWRJbmRleCA9IHBhZ2VzLmZpbmRJbmRleCggeCA9PiBgLyR7eC5yb3V0ZX1gID09PSB1cmwuc3BsaXQoJz8nKSBbIDAgXSk7XG5cbiAgICAgICAgLy8g5aaC5p6c5om+5Yiw5Y6G5Y+y6Lev55SxXG4gICAgICAgIGlmICggISFleGlzdGVkVGFyZ2V0ICkge1xuXG4gICAgICAgICAgICBjb25zdCBpc1BhcmFtRXF1YWwgPSBqdWRnZUVxdWFsKCBwYXJhbXMsIGV4aXN0ZWRUYXJnZXQub3B0aW9ucyApO1xuXG4gICAgICAgICAgICBpZiAoIGlzUGFyYW1FcXVhbCApIHtcbiAgICAgICAgICAgICAgICAvLyDlj4LmlbDljLnphY3nmoTmg4XlhrXkuIvvvIznq4vpqazov5Tlm55cbiAgICAgICAgICAgICAgICB3eC5uYXZpZ2F0ZUJhY2soe1xuICAgICAgICAgICAgICAgICAgICBkZWx0YTogcGFnZUxlbiAtIGV4aXN0ZWRJbmRleCAtIDFcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgLy8gdXJs5Yy56YWN77yM5L2G5piv5Y+C5pWw5LiN5Yy56YWNXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vIHd4Lm5hdmlnYXRlQmFjayh7XG4gICAgICAgICAgICAgICAgLy8gICAgIGRlbHRhOiBwYWdlTGVuIC0gZXhpc3RlZEluZGV4XG4gICAgICAgICAgICAgICAgLy8gfSk7XG4gICAgICAgICAgICAgICAgLy8gd3gubmF2aWdhdGVUbyh7XG4gICAgICAgICAgICAgICAgLy8gICAgIHVybFxuICAgICAgICAgICAgICAgIC8vIH0pO1xuXG4gICAgICAgICAgICAgICAgLy8g5om+5LiN5Yiw77yM5LiU5LiN6LaF6L+HbWF4XG4gICAgICAgICAgICAgICAgaWYgKCBwYWdlTGVuIDwgTUFYX1BBR0VTICkge1xuICAgICAgICAgICAgICAgICAgICB3eC5uYXZpZ2F0ZVRvKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHVybFxuICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIC8vIOaJvuS4jeWIsO+8jOS4lOi2hei/h+S6hm1heFxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHd4LnJlZGlyZWN0VG8oe1xuICAgICAgICAgICAgICAgICAgICAgICAgdXJsXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICB9IGVsc2Uge1xuXG4gICAgICAgICAgICAvLyDmib7kuI3liLDvvIzkuJTkuI3otoXov4dtYXhcbiAgICAgICAgICAgIGlmICggcGFnZUxlbiA8IE1BWF9QQUdFUyApIHtcbiAgICAgICAgICAgICAgICB3eC5uYXZpZ2F0ZVRvKHtcbiAgICAgICAgICAgICAgICAgICAgdXJsXG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIC8vIOaJvuS4jeWIsO+8jOS4lOi2hei/h+S6hm1heFxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB3eC5yZWRpcmVjdFRvKHtcbiAgICAgICAgICAgICAgICAgICAgdXJsXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbn07Il19